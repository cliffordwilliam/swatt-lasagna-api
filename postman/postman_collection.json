{
  "info": {
    "_postman_id": "388b4348-a74d-49e2-9399-c77a2d7526ef",
    "name": "Swatt Lasagna API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "28966522"
  },
  "item": [
    {
      "name": "Item",
      "item": [
        {
          "name": "Create a New Item",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const timestamp = Date.now();",
                  "const uniqueItemName = `Test Item ${timestamp}`;",
                  "pm.environment.set(\"item_name\", uniqueItemName);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Create a new item\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "});",
                  "",
                  "if (json.data && json.data.itemId) {",
                  "    pm.environment.set(\"item_id\", json.data.itemId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"itemName\": \"{{item_name}}\",\n  \"price\": 123\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/item",
              "host": ["{{base_url}}"],
              "path": ["item"]
            }
          },
          "response": []
        },
        {
          "name": "Update an Item",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const timestamp = Date.now();",
                  "const uniqueUpdatedItemName = `Updated Item ${timestamp}`;",
                  "pm.environment.set(\"updated_item_name\", uniqueUpdatedItemName);",
                  "pm.environment.set(\"updated_item_price\", 999);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Item updated successfully\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.price).to.eql(Number(pm.environment.get(\"updated_item_price\")));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"itemName\": \"{{updated_item_name}}\",\n  \"price\": {{updated_item_price}}\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/item/{{item_id}}",
              "host": ["{{base_url}}"],
              "path": ["item", "{{item_id}}"]
            }
          }
        },
        {
          "name": "List Items",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"List items\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.be.an('array');",
                  "    pm.expect(json.meta).to.have.property('page');",
                  "    pm.expect(json.meta).to.have.property('pageSize');",
                  "    pm.expect(json.meta).to.have.property('totalCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/item",
              "host": ["{{base_url}}"],
              "path": ["item"]
            }
          }
        },
        {
          "name": "Get an Item by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Get an Item by ID\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.itemId).to.eql(Number(pm.environment.get(\"item_id\")));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/item/{{item_id}}",
              "host": ["{{base_url}}"],
              "path": ["item", "{{item_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Person",
      "item": [
        {
          "name": "Create a New Person",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Create a new person\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.have.property(\"personId\");",
                  "    pm.expect(json.data).to.have.property(\"personName\");",
                  "    pm.expect(json.data).to.have.property(\"phones\");",
                  "    pm.expect(json.data).to.have.property(\"addresses\");",
                  "});",
                  "",
                  "if (json.data && json.data.personId) {",
                  "    pm.environment.set(\"person_id\", json.data.personId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"personName\": \"John Doe\",\n  \"phoneNumber\": \"555-1234\",\n  \"address\": \"123 Main Street, City, Country\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/person",
              "host": ["{{base_url}}"],
              "path": ["person"]
            }
          },
          "response": []
        },
        {
          "name": "List Persons",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"List persons\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.be.an('array');",
                  "    pm.expect(json.meta).to.have.property('page');",
                  "    pm.expect(json.meta).to.have.property('pageSize');",
                  "    pm.expect(json.meta).to.have.property('totalCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/person",
              "host": ["{{base_url}}"],
              "path": ["person"]
            }
          }
        },
        {
          "name": "Get a Person by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Get a Person by ID\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.personId).to.eql(Number(pm.environment.get(\"person_id\")));",
                  "    pm.expect(json.data).to.have.property('personName');",
                  "    pm.expect(json.data).to.have.property('phones');",
                  "    pm.expect(json.data).to.have.property('addresses');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/person/{{person_id}}",
              "host": ["{{base_url}}"],
              "path": ["person", "{{person_id}}"]
            }
          }
        },
        {
          "name": "Update a Person",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Person updated successfully\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.personId).to.eql(Number(pm.environment.get(\"person_id\")));",
                  "    pm.expect(json.data.personName).to.eql(\"Jane Doe Updated\");",
                  "    pm.expect(json.data).to.have.property('phones');",
                  "    pm.expect(json.data).to.have.property('addresses');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"personName\": \"Jane Doe Updated\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/person/{{person_id}}",
              "host": ["{{base_url}}"],
              "path": ["person", "{{person_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Order",
      "item": [
        {
          "name": "Create a New Order",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const timestamp = Date.now();",
                  "const uniquePO = `PO-${timestamp}`;",
                  "pm.environment.set(\"order_po\", uniquePO);",
                  "",
                  "const orderDate = new Date();",
                  "const deliveryDate = new Date();",
                  "deliveryDate.setDate(deliveryDate.getDate() + 7);",
                  "pm.environment.set(\"order_date\", orderDate.toISOString().split('T')[0]);",
                  "pm.environment.set(\"delivery_date\", deliveryDate.toISOString().split('T')[0]);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Create a new order\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.have.property(\"orderId\");",
                  "    pm.expect(json.data).to.have.property(\"po\");",
                  "    pm.expect(json.data).to.have.property(\"buyerId\");",
                  "    pm.expect(json.data).to.have.property(\"recipientId\");",
                  "    pm.expect(json.data).to.have.property(\"orderDate\");",
                  "    pm.expect(json.data).to.have.property(\"deliveryDate\");",
                  "    pm.expect(json.data).to.have.property(\"totalPurchase\");",
                  "    pm.expect(json.data).to.have.property(\"pickupDelivery\");",
                  "    pm.expect(json.data).to.have.property(\"shippingCost\");",
                  "    pm.expect(json.data).to.have.property(\"grandTotal\");",
                  "    pm.expect(json.data).to.have.property(\"payment\");",
                  "    pm.expect(json.data).to.have.property(\"orderStatus\");",
                  "    pm.expect(json.data).to.have.property(\"orderItems\");",
                  "    pm.expect(json.data.orderItems).to.be.an('array');",
                  "    pm.expect(json.data.orderItems.length).to.be.greaterThan(0);",
                  "});",
                  "",
                  "if (json.data && json.data.orderId) {",
                  "    pm.environment.set(\"order_id\", json.data.orderId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"po\": \"{{order_po}}\",\n  \"buyer\": {\n    \"personName\": \"John Buyer\",\n    \"phone\": {\n      \"phoneNumber\": \"555-1001\",\n      \"preferred\": true\n    },\n    \"address\": {\n      \"address\": \"123 Buyer Street, City, Country\",\n      \"preferred\": true\n    }\n  },\n  \"recipient\": {\n    \"personName\": \"Jane Recipient\",\n    \"phone\": {\n      \"phoneNumber\": \"555-2002\",\n      \"preferred\": true\n    },\n    \"address\": {\n      \"address\": \"456 Recipient Avenue, City, Country\",\n      \"preferred\": true\n    }\n  },\n  \"orderDate\": \"{{order_date}}\",\n  \"deliveryDate\": \"{{delivery_date}}\",\n  \"pickupDelivery\": \"Delivery\",\n  \"shippingCost\": 5000,\n  \"payment\": \"Transfer Bank\",\n  \"orderStatus\": \"Belum bayar\",\n  \"items\": [\n    {\n      \"itemId\": {{item_id}},\n      \"quantity\": 2\n    }\n  ],\n  \"note\": \"Please handle with care\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/order",
              "host": ["{{base_url}}"],
              "path": ["order"]
            }
          },
          "response": []
        },
        {
          "name": "List Orders",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"List orders\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.be.an('array');",
                  "    pm.expect(json.meta).to.have.property('page');",
                  "    pm.expect(json.meta).to.have.property('pageSize');",
                  "    pm.expect(json.meta).to.have.property('totalCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/order",
              "host": ["{{base_url}}"],
              "path": ["order"]
            }
          }
        },
        {
          "name": "Get an Order by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Get an Order by ID\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.orderId).to.eql(Number(pm.environment.get(\"order_id\")));",
                  "    pm.expect(json.data).to.have.property('po');",
                  "    pm.expect(json.data).to.have.property('buyerId');",
                  "    pm.expect(json.data).to.have.property('recipientId');",
                  "    pm.expect(json.data).to.have.property('orderItems');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/order/{{order_id}}",
              "host": ["{{base_url}}"],
              "path": ["order", "{{order_id}}"]
            }
          }
        },
        {
          "name": "Update an Order",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const timestamp = Date.now();",
                  "const uniqueUpdatedPO = `PO-UPDATED-${timestamp}`;",
                  "pm.environment.set(\"updated_order_po\", uniqueUpdatedPO);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Order updated successfully\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.orderId).to.eql(Number(pm.environment.get(\"order_id\")));",
                  "    pm.expect(json.data.po).to.eql(pm.environment.get(\"updated_order_po\"));",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"po\": \"{{updated_order_po}}\",\n  \"note\": \"Updated note\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/order/{{order_id}}",
              "host": ["{{base_url}}"],
              "path": ["order", "{{order_id}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Person Phone",
      "item": [
        {
          "name": "Create a New Person Phone",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Create a new person phone\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.have.property(\"phoneId\");",
                  "    pm.expect(json.data).to.have.property(\"personId\");",
                  "    pm.expect(json.data).to.have.property(\"phoneNumber\");",
                  "    pm.expect(json.data).to.have.property(\"preferred\");",
                  "});",
                  "",
                  "if (json.data && json.data.phoneId) {",
                  "    pm.environment.set(\"person_phone_id\", json.data.phoneId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"personId\": {{person_id}},\n  \"phoneNumber\": \"555-9999\",\n  \"preferred\": false\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/person-phone",
              "host": ["{{base_url}}"],
              "path": ["person-phone"]
            }
          },
          "response": []
        },
        {
          "name": "List Person Phones",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"List person phones\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.be.an('array');",
                  "    pm.expect(json.meta).to.have.property('page');",
                  "    pm.expect(json.meta).to.have.property('pageSize');",
                  "    pm.expect(json.meta).to.have.property('totalCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/person-phone",
              "host": ["{{base_url}}"],
              "path": ["person-phone"]
            }
          }
        },
        {
          "name": "Get a Person Phone by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Get a Person Phone by ID\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.phoneId).to.eql(Number(pm.environment.get(\"person_phone_id\")));",
                  "    pm.expect(json.data).to.have.property('phoneNumber');",
                  "    pm.expect(json.data).to.have.property('personId');",
                  "    pm.expect(json.data).to.have.property('preferred');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/person-phone/{{person_phone_id}}",
              "host": ["{{base_url}}"],
              "path": ["person-phone", "{{person_phone_id}}"]
            }
          }
        },
        {
          "name": "Update a Person Phone",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Person Phone updated successfully\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.phoneId).to.eql(Number(pm.environment.get(\"person_phone_id\")));",
                  "    pm.expect(json.data.phoneNumber).to.eql(\"555-8888\");",
                  "    pm.expect(json.data.preferred).to.eql(true);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phoneNumber\": \"555-8888\",\n  \"preferred\": true\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/person-phone/{{person_phone_id}}?personId={{person_id}}",
              "host": ["{{base_url}}"],
              "path": ["person-phone", "{{person_phone_id}}"],
              "query": [
                {
                  "key": "personId",
                  "value": "{{person_id}}"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Person Address",
      "item": [
        {
          "name": "Create a New Person Address",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Create a new person address\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.have.property(\"addressId\");",
                  "    pm.expect(json.data).to.have.property(\"personId\");",
                  "    pm.expect(json.data).to.have.property(\"address\");",
                  "    pm.expect(json.data).to.have.property(\"preferred\");",
                  "});",
                  "",
                  "if (json.data && json.data.addressId) {",
                  "    pm.environment.set(\"person_address_id\", json.data.addressId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"personId\": {{person_id}},\n  \"address\": \"789 New Street, City, Country\",\n  \"preferred\": false\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/person-address",
              "host": ["{{base_url}}"],
              "path": ["person-address"]
            }
          },
          "response": []
        },
        {
          "name": "List Person Addresses",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"List person addresses\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data).to.be.an('array');",
                  "    pm.expect(json.meta).to.have.property('page');",
                  "    pm.expect(json.meta).to.have.property('pageSize');",
                  "    pm.expect(json.meta).to.have.property('totalCount');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/person-address",
              "host": ["{{base_url}}"],
              "path": ["person-address"]
            }
          }
        },
        {
          "name": "Get a Person Address by ID",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Get a Person Address by ID\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.addressId).to.eql(Number(pm.environment.get(\"person_address_id\")));",
                  "    pm.expect(json.data).to.have.property('address');",
                  "    pm.expect(json.data).to.have.property('personId');",
                  "    pm.expect(json.data).to.have.property('preferred');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/person-address/{{person_address_id}}",
              "host": ["{{base_url}}"],
              "path": ["person-address", "{{person_address_id}}"]
            }
          }
        },
        {
          "name": "Update a Person Address",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "",
                  "pm.test(\"Person Address updated successfully\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "    pm.expect(json.data.addressId).to.eql(Number(pm.environment.get(\"person_address_id\")));",
                  "    pm.expect(json.data.address).to.eql(\"999 Updated Avenue, City, Country\");",
                  "    pm.expect(json.data.preferred).to.eql(true);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"address\": \"999 Updated Avenue, City, Country\",\n  \"preferred\": true\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/person-address/{{person_address_id}}?personId={{person_id}}",
              "host": ["{{base_url}}"],
              "path": ["person-address", "{{person_address_id}}"],
              "query": [
                {
                  "key": "personId",
                  "value": "{{person_id}}"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Order Snapshot Scenarios",
      "item": [
        {
          "name": "Create Setup Item",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const timestamp = Date.now();",
                  "const uniqueItemName = `Snapshot Test Item ${timestamp}`;",
                  "pm.environment.set(\"snapshot_test_item_name\", uniqueItemName);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"Setup item created\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.success).to.eql(true);",
                  "});",
                  "if (json.data && json.data.itemId) {",
                  "    pm.environment.set(\"snapshot_test_item_id\", json.data.itemId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"itemName\": \"{{snapshot_test_item_name}}\",\n  \"price\": 100\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/item",
              "host": ["{{base_url}}"],
              "path": ["item"]
            }
          }
        },
        {
          "name": "Create Order - No Snapshot Override",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const timestamp = Date.now();",
                  "pm.environment.set(\"snapshot_test_po_1\", `PO-SNAP-1-${timestamp}`);",
                  "const date = new Date().toISOString().split('T')[0];",
                  "pm.environment.set(\"snapshot_test_date\", date);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"Order created without override\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.data.orderItems[0].itemName).to.eql(pm.environment.get(\"snapshot_test_item_name\"));",
                  "    pm.expect(json.data.orderItems[0].itemPrice).to.eql(100);",
                  "});",
                  "if (json.data && json.data.orderId) {",
                  "    pm.environment.set(\"snapshot_test_order_id_1\", json.data.orderId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"po\": \"{{snapshot_test_po_1}}\",\n  \"buyer\": {\n    \"personName\": \"Snapshot Buyer\"\n  },\n  \"recipient\": {\n    \"personName\": \"Snapshot Recipient\"\n  },\n  \"orderDate\": \"{{snapshot_test_date}}\",\n  \"deliveryDate\": \"{{snapshot_test_date}}\",\n  \"pickupDelivery\": \"Pickup\",\n  \"shippingCost\": 0,\n  \"payment\": \"Tunai\",\n  \"orderStatus\": \"Belum bayar\",\n  \"items\": [\n    {\n      \"itemId\": {{snapshot_test_item_id}},\n      \"quantity\": 1\n    }\n  ]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/order",
              "host": ["{{base_url}}"],
              "path": ["order"]
            }
          }
        },
        {
          "name": "Create Order - With Snapshot Override",
          "event": [
            {
              "listen": "prerequest",
              "script": {
                "exec": [
                  "const timestamp = Date.now();",
                  "pm.environment.set(\"snapshot_test_po_2\", `PO-SNAP-2-${timestamp}`);"
                ],
                "type": "text/javascript"
              }
            },
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"Order created with override\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.data.orderItems[0].itemName).to.eql(\"Override Name\");",
                  "    pm.expect(json.data.orderItems[0].itemPrice).to.eql(999);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"po\": \"{{snapshot_test_po_2}}\",\n  \"buyer\": {\n    \"personName\": \"Snapshot Buyer\"\n  },\n  \"recipient\": {\n    \"personName\": \"Snapshot Recipient\"\n  },\n  \"orderDate\": \"{{snapshot_test_date}}\",\n  \"deliveryDate\": \"{{snapshot_test_date}}\",\n  \"pickupDelivery\": \"Pickup\",\n  \"shippingCost\": 0,\n  \"payment\": \"Tunai\",\n  \"orderStatus\": \"Belum bayar\",\n  \"items\": [\n    {\n      \"itemId\": {{snapshot_test_item_id}},\n      \"quantity\": 1,\n      \"itemName\": \"Override Name\",\n      \"itemPrice\": 999\n    }\n  ]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/order",
              "host": ["{{base_url}}"],
              "path": ["order"]
            }
          }
        },
        {
          "name": "Update Order - No Snapshot Override",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"Order updated without override (reset)\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.data.orderItems[0].itemName).to.eql(pm.environment.get(\"snapshot_test_item_name\"));",
                  "    pm.expect(json.data.orderItems[0].itemPrice).to.eql(100);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"items\": [\n    {\n      \"itemId\": {{snapshot_test_item_id}},\n      \"quantity\": 5\n    }\n  ]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/order/{{snapshot_test_order_id_1}}",
              "host": ["{{base_url}}"],
              "path": ["order", "{{snapshot_test_order_id_1}}"]
            }
          }
        },
        {
          "name": "Update Order - With Snapshot Override",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const json = pm.response.json();",
                  "pm.test(\"Order updated with override\", function () {",
                  "    pm.expect(pm.response.code).to.eql(200);",
                  "    pm.expect(json.data.orderItems[0].itemName).to.eql(\"Update Override\");",
                  "    pm.expect(json.data.orderItems[0].itemPrice).to.eql(888);",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"items\": [\n    {\n      \"itemId\": {{snapshot_test_item_id}},\n      \"quantity\": 5,\n      \"itemName\": \"Update Override\",\n      \"itemPrice\": 888\n    }\n  ]\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/order/{{snapshot_test_order_id_1}}",
              "host": ["{{base_url}}"],
              "path": ["order", "{{snapshot_test_order_id_1}}"]
            }
          }
        }
      ]
    }
  ]
}
